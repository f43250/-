# JVM

## 内存模型
-  线程私有
   - 程序计数器:
     1. 字节码解释器选取接下来执行的指令就是通过改变程序计数器的值
     2. 每个线程都有独立的程序计数器
     3. 如果执行的是java方法,程序计数器的值为接下来执行的字节码指令地址,若果是本地方法,则为undefined 
   - 虚拟机栈
   - 本地方法栈
- 线程共享
   - 堆:
   - 方法区: 

## 参数

| 参数名称 | 作用 | Java Performance推荐值|
| ---- | ---- | ---- |
| Xmx/Xms | 最大/小堆空间 |设置为老年代存活对象的3-4倍|
| Xmn | 新生代 | 设置为老年代存活对象的1-1.5倍 |
| MaxPermSize/PermSize  | 1.8以前永久代 | 设置为老年代存活对象的1.2-1.5倍。|
| MaxMetaspaceSize/MetaspaceSize  | 1.8之后元空间 | 设置为老年代存活对象的1.2-1.5倍。|
| -XX:+PrintGC/-XX:+PrintGCDetails | 打印GC/GC详细日志 |

- `如何确定老年代大小? ` 

JVM参数中添加GC日志，GC日志中会记录每次FullGC之后各代的内存大小，观察老年代GC之后的空间大小。可观察一段时间内（比如2天）的FullGC之后的内存情况，根据多次的FullGC之后的老年代的空间大小数据来预估FullGC之后老年代的存活对象大小（可根据多次FullGC之后的内存大小取平均值）
